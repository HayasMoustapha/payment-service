# ğŸ’³ Event Planner - Payment Service Environment Configuration
#
# ğŸ“‹ GUIDE D'UTILISATION :
# 1. Copier ce fichier en .env.local pour le dÃ©veloppement
# 2. Copier ce fichier en .env pour la production
# 3. Remplacer les valeurs par dÃ©faut par vos vraies clÃ©s
# 4. NE JAMAIS COMMITTER le fichier .env contenant des secrets !

# ===========================================
# ğŸš€ SERVEUR & ENVIRONNEMENT
# ===========================================
PORT=3003
# ğŸ¯ Port d'Ã©coute du service (doit Ãªtre unique par service)
NODE_ENV=development
# ğŸŒ Environnement : development | staging | production

# ===========================================
# ğŸ—„ï¸ BASE DE DONNÃ‰ES POSTGRESQL
# ===========================================
DB_HOST=localhost
# ğŸ  HÃ´te de la base de donnÃ©es (localhost en dev, RDS endpoint en prod)
DB_PORT=5432
# ğŸšª Port PostgreSQL (5432 par dÃ©faut)
DB_NAME=event_planner_payments
# ğŸ“Š Nom de la base de donnÃ©es (prÃ©fixe event_planner_ recommandÃ©)
DB_USER=postgres
# ğŸ‘¤ Utilisateur PostgreSQL (crÃ©er un utilisateur dÃ©diÃ© en prod)
DB_PASSWORD=postgres
# ğŸ” Mot de passe PostgreSQL (utiliser un mot de passe fort en prod)
DB_SSL=false
# ğŸ”’ Connexion SSL (true en production avec RDS)

# Pool de connexions pour optimiser les performances
DB_POOL_MIN=2
# ğŸ”¢ Nombre minimum de connexions dans le pool
DB_POOL_MAX=10
# ğŸ”¢ Nombre maximum de connexions dans le pool
DB_POOL_IDLE_TIMEOUT=30000
# â° Timeout d'inactivitÃ© des connexions (ms)

# Bootstrap automatique de la base de donnÃ©es
# âš ï¸  DÃ‰SACTIVÃ‰ PAR DÃ‰FAUT EN PRODUCTION POUR SÃ‰CURITÃ‰
# âœ… true : CrÃ©e automatiquement les tables et index au dÃ©marrage
# âŒ false : NÃ©cessite une migration manuelle en production
DB_AUTO_BOOTSTRAP=false

# ===========================================
# ğŸ” AUTHENTIFICATION UNIFIÃ‰E
# ===========================================
# âš ï¸ IMPORTANT: Utiliser le mÃªme secret que l'auth service
# ğŸ”‘ GÃ©nÃ©rer une clÃ© sÃ©curisÃ©e : openssl rand -base64 32
JWT_SECRET=your_super_secure_256_bit_secret_key_change_in_production
# ğŸ” ClÃ© secrÃ¨te pour vÃ©rifier les tokens JWT (doit Ãªtre identique Ã  l'Auth Service)

# Configuration JWT avancÃ©e
JWT_ALGORITHM=HS256
# ğŸ› ï¸ Algorithme de signature (doit Ãªtre identique Ã  l'Auth Service)
JWT_ISSUER=auth-service
# ğŸ¢ Ã‰metteur attendu des tokens JWT (doit Ãªtre identique Ã  l'Auth Service)
JWT_AUDIENCE=event-planner
# ğŸ‘¥ Audience du token (doit Ãªtre identique Ã  l'Auth Service)

# Configuration validation JWT
JWT_VERIFY_ISSUER=true
# âœ… VÃ©rifier l'Ã©metteur du token (sÃ©curitÃ©)
JWT_VERIFY_AUDIENCE=true
# âœ… VÃ©rifier l'audience du token (sÃ©curitÃ©)
JWT_VERIFY_EXPIRATION=true
# âœ… VÃ©rifier l'expiration du token (sÃ©curitÃ©)
JWT_MAX_AGE=7d
# ğŸ“… Ã‚ge maximum du token acceptÃ©
JWT_CLOCK_TOLERANCE=0
# â° TolÃ©rance de temps (pour les dÃ©calages d'horloge)

# ===========================================
# ğŸŒ INTER-SERVICES COMMUNICATION
# ===========================================
# Token partagÃ© pour communication entre services
# ğŸ”‘ GÃ©nÃ©rer : openssl rand -base64 32 (doit Ãªtre identique partout)
SHARED_SERVICE_TOKEN=shared-service-token-abcdef12345678901234567890
# ğŸ” Token pour authentifier les communications inter-services

# URLs des autres services (pour health checks et communication)
AUTH_SERVICE_URL=http://localhost:3000
# ğŸ” URL du service d'authentification
CORE_SERVICE_URL=http://localhost:3001
# ğŸ¯ URL du service principal
NOTIFICATION_SERVICE_URL=http://localhost:3002
# ğŸ“§ URL du service de notifications
TICKET_GENERATOR_SERVICE_URL=http://localhost:3004
# ğŸ« URL du service de gÃ©nÃ©ration de tickets
SCAN_VALIDATION_SERVICE_URL=http://localhost:3005
# ğŸ” URL du service de validation

# Timeout pour les appels HTTP inter-services
INTER_SERVICE_TIMEOUT=30000
# â° Timeout par dÃ©faut (30000ms = 30 secondes)
INTER_SERVICE_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry
INTER_SERVICE_RETRY_DELAY=1000
# â° DÃ©lai entre les retries (1000ms = 1 seconde)

# ===========================================
# ğŸ’¾ CACHE REDIS
# ===========================================
REDIS_HOST=localhost
# ğŸ  HÃ´te Redis (localhost en dev, ElastiCache endpoint en prod)
REDIS_PORT=6379
# ğŸšª Port Redis (6379 par dÃ©faut)
REDIS_PASSWORD=your_redis_password
# ğŸ” Mot de passe Redis (recommandÃ© en production)
REDIS_DB=3
# ğŸ“Š NumÃ©ro de la base Redis (3 pour Payment Service)

# Configuration du cache
CACHE_TTL=3600
# â° DurÃ©e de vie du cache en secondes (3600 = 1 heure)
CACHE_MAX_KEYS=10000
# ğŸ”¢ Nombre maximum de clÃ©s en cache

# ===========================================
# ğŸ’³ STRIPE PAYMENT PROCESSOR
# ===========================================
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
# ğŸ”‘ ClÃ© secrÃ¨te Stripe (test : sk_test_, prod : sk_live_)
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
# ğŸ”‘ ClÃ© publique Stripe (test : pk_test_, prod : pk_live_)
STRIPE_WEBHOOK_SECRET=whsec_your_stripe_webhook_secret
# ğŸ” Secret webhook Stripe (pour vÃ©rifier les webhooks entrants)

# Configuration Stripe avancÃ©e
STRIPE_API_VERSION=2023-10-16
# ğŸ“… Version API Stripe (utiliser la derniÃ¨re version stable)
STRIPE_DEFAULT_CURRENCY=eur
# ğŸ’± Devise par dÃ©faut (eur, usd, gbp, etc.)
STRIPE_MINIMUM_AMOUNT=100
# ğŸ’° Montant minimum en centimes (100 = 1.00â‚¬)

# Configuration des frais Stripe
STRIPE_APPLICATION_FEE_PERCENT=2.9
# ğŸ“Š Pourcentage de frais d'application (2.9% par dÃ©faut)
STRIPE_APPLICATION_FEE_FIXED=30
# ğŸ’° Frais fixes en centimes (30 = 0.30â‚¬)

# ===========================================
# ğŸ’³ PAYPAL PAYMENT PROCESSOR
# ===========================================
PAYPAL_CLIENT_ID=your_paypal_client_id
# ğŸ”‘ ID client PayPal (obtenir depuis developer.paypal.com)
PAYPAL_CLIENT_SECRET=your_paypal_client_secret
# ğŸ” Secret client PayPal
PAYPAL_WEBHOOK_ID=your_paypal_webhook_id
# ğŸ”‘ ID webhook PayPal (pour la validation)

# Configuration PayPal
PAYPAL_MODE=sandbox
# ğŸ§ª Mode PayPal : sandbox | live
PAYPAL_API_BASE_URL=https://api-m.sandbox.paypal.com
# ğŸ”— URL API PayPal (sandbox ou live)
PAYPAL_WEBHOOK_URL=https://api-m.paypal.com/v1/notifications/webhooks
# ğŸ”— URL webhook PayPal (live)

# ===========================================
# ğŸ’³ PAYMENT CONFIGURATION
# ===========================================
ENABLE_PAYMENT_PROCESSING=true
# âœ… Activer le traitement des paiements
DEFAULT_CURRENCY=EUR
# ğŸ’± Devise par dÃ©faut pour tous les paiements
PAYMENT_TIMEOUT_MINUTES=30
# â° Timeout pour finaliser un paiement (30 minutes)
MIN_PAYMENT_AMOUNT=1.00
# ğŸ’° Montant minimum de paiement (1.00â‚¬)
MAX_PAYMENT_AMOUNT=100000.00
# ğŸ’° Montant maximum de paiement (1000.00â‚¬)

# Configuration des remboursements
ENABLE_REFUNDS=true
# âœ… Activer les remboursements
REFUND_WINDOW_DAYS=30
# ğŸ“… FenÃªtre de temps pour les remboursements (30 jours)
AUTO_REFUND_FAILED_PAYMENTS=false
# ğŸ”„ Rembourser automatiquement les paiements Ã©chouÃ©s
REFUND_PROCESSING_FEE=true
# ğŸ’° Inclure les frais de traitement dans les remboursements

# ===========================================
# ğŸ“§ INVOICES & RECEIPTS
# ===========================================
INVOICE_TEMPLATE_PATH=./templates/invoices
# ğŸ“ Chemin des templates de factures
INVOICE_LOGO_PATH=./assets/logo.png
# ğŸ–¼ï¸ Chemin du logo pour les factures
INVOICE_COMPANY_NAME=Event Planner SAS
# ğŸ¢ Nom de l'entreprise sur les factures
INVOICE_COMPANY_ADDRESS=123 Rue de l'Ã‰vÃ©nement, 75001 Paris, France
# ğŸ“ Adresse de l'entreprise
INVOICE_COMPANY_SIRET=12345678901234
# ğŸ“‹ NumÃ©ro SIRET de l'entreprise
INVOICE_COMPANY_EMAIL=contact@eventplanner.com
# ğŸ“§ Email de contact de l'entreprise
INVOICE_COMPANY_PHONE=+33 1 23 45 67 89
# ğŸ“± TÃ©lÃ©phone de l'entreprise

# Configuration des factures PDF
ENABLE_PDF_INVOICES=true
# ğŸ“„ Activer la gÃ©nÃ©ration de factures PDF
INVOICE_NUMBER_PREFIX=INV
# ğŸ”¢ PrÃ©fixe pour les numÃ©ros de facture
INVOICE_NUMBER_LENGTH=8
# ğŸ”¢ Longueur du numÃ©ro de facture
INVOICE_STORAGE_PATH=./invoices
# ğŸ“ Chemin de stockage des factures gÃ©nÃ©rÃ©es

# ===========================================
# ğŸ›¡ï¸ FRAUD DETECTION
# ===========================================
ENABLE_FRAUD_DETECTION=true
# âœ… Activer la dÃ©tection de fraude
MAX_PAYMENT_ATTEMPTS_PER_IP=5
# ğŸŒ Nombre max de tentatives de paiement par IP
SUSPICIOUS_AMOUNT_THRESHOLD=10000
# ğŸ’° Seuil de montant suspect (10000 centimes = 100â‚¬)
FRAUD_CHECK_TIMEOUT=5000
# â° Timeout pour les vÃ©rifications de fraude (5 secondes)

# Configuration des rÃ¨gles de fraude
ENABLE_IP_BLACKLIST_CHECK=true
# âœ… VÃ©rifier les IPs dans la blacklist
ENABLE_VELOCITY_CHECK=true
# âœ… VÃ©rifier la vitesse des transactions
VELOCITY_WINDOW_MINUTES=10
# â° FenÃªtre de temps pour la vÃ©rification de vitesse
MAX_PAYMENTS_PER_WINDOW=3
# ğŸ”¢ Max de paiements dans la fenÃªtre de temps

# ===========================================
# ğŸ“ LOGGING
# ===========================================
LOG_LEVEL=info
# ğŸ“Š Niveau de log : error | warn | info | debug
LOG_FILE_PATH=logs
# ğŸ“ Chemin des fichiers de log
LOG_MAX_SIZE=20MB
# ğŸ“ Taille maximale d'un fichier de log
LOG_MAX_FILES=14d
# ğŸ“… DurÃ©e de rÃ©tention des logs (14 jours recommandÃ©)

# Activer les logs structurÃ©s
ENABLE_STRUCTURED_LOGS=true
# ğŸ“Š Activer les logs au format JSON
ENABLE_REQUEST_LOGGING=true
# ğŸ“ Activer les logs des requÃªtes HTTP
ENABLE_PAYMENT_LOGGING=true
# ğŸ’³ Activer les logs dÃ©taillÃ©s des paiements
ENABLE_FRAUD_LOGGING=true
# ğŸ›¡ï¸ Activer les logs de dÃ©tection de fraude

# ===========================================
# ğŸ“Š MONITORING
# ===========================================
ENABLE_METRICS=true
# ğŸ“ˆ Activer les mÃ©triques Prometheus
METRICS_PORT=9093
# ğŸšª Port pour les mÃ©triques (doit Ãªtre unique)
ENABLE_HEALTH_CHECKS=true
# âœ… Activer les health checks dÃ©taillÃ©s
ENABLE_PERFORMANCE_MONITORING=true
# ğŸ“ˆ Activer le monitoring des performances

# ===========================================
# ğŸš¦ RATE LIMITING
# ===========================================
RATE_LIMIT_WINDOW_MS=900000
# â° FenÃªtre de temps pour le rate limiting (900000ms = 15 minutes)
RATE_LIMIT_MAX_REQUESTS=200
# ğŸ”¢ Nombre max de requÃªtes par fenÃªtre (global)
PAYMENT_ATTEMPT_RATE_LIMIT=10
# ğŸ’³ Limite de tentatives de paiement par fenÃªtre
REFUND_RATE_LIMIT=5
# ğŸ”„ Limite de remboursements par fenÃªtre

# Rate limiting spÃ©cifique par endpoint
PAYMENT_CREATE_RATE_LIMIT=50
# ğŸ’³ Limite pour la crÃ©ation de paiements
PAYMENT_VERIFY_RATE_LIMIT=100
# âœ… Limite pour la vÃ©rification de paiements

# ===========================================
# ğŸ”„ WEBHOOKS
# ===========================================
ENABLE_WEBHOOKS=true
# âœ… Activer les webhooks pour les Ã©vÃ©nements de paiement
WEBHOOK_TIMEOUT=10000
# â° Timeout pour les webhooks (10000ms = 10 secondes)
WEBHOOK_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry pour les webhooks
WEBHOOK_RETRY_DELAY=2000
# â° DÃ©lai entre les retries (2000ms = 2 secondes)
WEBHOOK_SECRET=your_payment_webhook_secret
# ğŸ” Secret pour signer les webhooks

# Configuration des webhooks
ENABLE_STRIPE_WEBHOOKS=true
# âœ… Activer les webhooks Stripe
ENABLE_PAYPAL_WEBHOOKS=true
# âœ… Activer les webhooks PayPal
WEBHOOK_SIGNATURE_HEADER=x-signature
# ğŸ“‹ En-tÃªte pour la signature webhook

# ===========================================
# ğŸ“Š PAYMENT STATISTICS
# ===========================================
ENABLE_DETAILED_LOGGING=true
# ğŸ“Š Activer les logs dÃ©taillÃ©s pour les statistiques
STATISTICS_RETENTION_DAYS=90
# ğŸ“… DurÃ©e de rÃ©tention des statistiques (jours)
ENABLE_REAL_TIME_STATS=true
# ğŸ“ˆ Activer les statistiques en temps rÃ©el
DAILY_REPORT_ENABLED=true
# ğŸ“Š Activer le rapport quotidien
ENABLE_REVENUE_TRACKING=true
# ğŸ’° Activer le suivi des revenus

# ===========================================
# ğŸ›¡ï¸ SÃ‰CURITÃ‰
# ===========================================
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:3003
# ğŸŒ Origines autorisÃ©es pour CORS (sÃ©parer par des virgules)
ENABLE_IP_WHITELIST=false
# âœ… Activer le whitelist d'IPs
ALLOWED_IPS=127.0.0.1,::1
# ğŸŒ Adresses IP autorisÃ©es (sÃ©parer par des virgules)
ENABLE_REQUEST_VALIDATION=true
# âœ… Activer la validation stricte des requÃªtes

# Configuration PCI DSS
ENABLE_PCI_COMPLIANCE=true
# âœ… Activer la conformitÃ© PCI DSS
ENCRYPT_CARD_DATA=true
# ğŸ” Chiffrer les donnÃ©es de carte
STORE_CARD_DATA=false
# ğŸ’³ Ne jamais stocker les donnÃ©es complÃ¨tes de carte

# ===========================================
# ğŸ§ª TESTS & DÃ‰VELOPPEMENT
# ===========================================
ENABLE_MOCK_SERVICES=false
# ğŸ§ª Activer les services mockÃ©s pour les tests
ENABLE_DEBUG_MODE=false
# ğŸ› Activer le mode debug (informations supplÃ©mentaires)
ENABLE_PERFORMANCE_PROFILING=false
# ğŸ“ˆ Activer le profiling des performances (uniquement en dev)

# Configuration de test
TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/event_planner_payments_test
# ğŸ§ª URL de la base de donnÃ©es de test
TEST_REDIS_URL=redis://localhost:6379/15
# ğŸ§ª URL Redis pour les tests
MOCK_PAYMENT_PROCESSING=true
# ğŸ’³ Mock le traitement des paiements en test
MOCK_STRIPE_RESPONSES=true
# ğŸ’³ Mock les rÃ©ponses Stripe en test
MOCK_PAYPAL_RESPONSES=true
# ğŸ’³ Mock les rÃ©ponses PayPal en test
